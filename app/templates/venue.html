{% extends "layout.html" %}
{% from 'macros.html' import render_field, render_edit_field %}

{% block sidebar %}

    <h4 class="title has-text-centered is-uppercase">{{venue.name}}</h4>
    <div class="venue-img-wrapper">
    <img class="venue_img" src="{{ url_for('static', filename=venue.img.decode('utf-8'))}}" alt="">
    </div>
    <blockquote class="has-text-centered" >{{venue.about}}</blockquote>
    {% if current_user.is_anonymous %}
    {% else %}
        {% if is_favorite %}
        <p class="has-text-centered">This is one of your favorite venues! <a href="{{url_for('delete_favorite_venue',id=venue.id)}}">Unfavorite?</a></p>
        {% else %}
        <p class="has-text-centered"><a href="{{url_for('add_favorite_venue', id=venue.id)}}">Add To Favorites</a></p>
        {% endif %}
    {% endif %}

<div class="rating-container">
    <div id="overall-rating">Overall<p>{{overall_rating}}</p></div>
    <div id="pit-rating">Pit<p>{{pit_rating}}</p></div>
    <div id="sound-rating">Sound<p>{{sound_rating}}</p></div>
    <div id="facility-rating">Facility<p>{{facility_rating}}</p></div>
</div>

<div class="recent-comments">
    <div class="recent-good"></div>
    <div class="recent-bad"></div>
</div>


{% endblock %}

{% block main_header %}
{% endblock%}

{% block main %}
    <div>
        <h4 class="title is-5 has-text-centered is-uppercase">Ratings</h4>
        {% for rating in ratings %}
        {% include "ratings.html" %}
        {% endfor %}
        {% if current_user.is_anonymous == false %}
        {# include 'rating_form.html' #}
        {% if record %}
        <form method="POST" action="" class="form">
            {{ form.hidden_tag() }}
            {% for field in form %}
                {{ render_edit_field(field, record) }}
            {% endfor %}
            <input type="submit" name="submit" placeholder="Submit">
        </form>
        {% else %}
        <form method="POST" action="" class="form">
            {{ form.hidden_tag() }}
            {% for field in form %}
                {{ render_field(field) }}
            {% endfor %}
        </form>
        {% endif %}

    {% if rating %}
    <div class="box">
    <h4 class="title has-text-centered is-6 is-uppercase">Updating Rating:</h4>
    <p><a href="{{url_for('user',id=rating.user_fk)}}">{{ rating.user_fk.username }}</a>: {{ rating.message }}. {{rating.rating_type}} {{ rating.rating }}/5</p>
    <img class="inline-avatar" src="{{ url_for('static', filename=rating.user_fk.avatar.decode('utf-8'))}}" alt="">
    {% elif show_ratings %}
    <h4>Add new Rating:</h4>
    {% endif %}
    
    {% if event %}
    {% elif show_events %}
    <h4>Add new Event:</h4>
    {% endif %}
        
    {% endif %}
    {% if rating %}
    <a href="{{ url_for('venue', id=rating.venue_fk.id)}}">Changed my mind, I don't want to Update</a>
    {% endif %}
    </div>
    <br>

    <div>
        <h4 class="title has-text-centered is-5 is-uppercase">Events</h4>
        <div class="venue-events" id="venue-events">
        </div>
    </div>



{% endblock %}


{% block script %}
{% for band in approved_bands %}
    <script>
        bands.push("{{band}}")
    </script>
{% endfor %}
<script>
    venueApi()
</script>
{% endblock %}